{% extends "base.html" %}

{% block content_title %}{{ match_profile.name }}{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{% url 'matrimony:matches' %}">Matches</a></li>
<li class="breadcrumb-item active">{{ match_profile.name }}</li>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-4 d-flex align-items-stretch">
        <div id="profilePhotoCarousel" class="carousel slide" data-ride="false" style="max-height: 520px;">
            <ol class="carousel-indicators" style="z-index: 4;">
                {% for photo in match_profile.photo_set.all %}
                    <li data-target="#profilePhotoCarousel" data-slide-to="{{ forloop.counter0 }}"{% if photo.primary %} class="active"{% endif %}></li>
                {% endfor %}
            </ol>
            <div class="carousel-inner" role="listbox">
                {% for photo in match_profile.photo_set.all %}
                    <div class="carousel-item{% if photo.primary or not match_profile.primary_image_url and forloop.counter0 == 0 %} active{% endif %}">
                        <img class="d-block img-fluid" src="{{ photo.photo.image.url }}" style="object-fit: cover;">
                    </div>
                {% endfor %}
            </div>
            <a class="carousel-control-prev" href="#profilePhotoCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#profilePhotoCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
    <div class="col-md-8">
        <div class="card bg-primary">
            <div class="card-body">
                <h4 class="header-title mt-0 mb-3 text-white">Overview</h4>
                <div class="text-left">
                    <p class="text-white">
                        <strong>Age:</strong><span class="ml-1 text-white-50">{{ match_profile.age }}</span>,
                        <strong>Height:</strong><span class="ml-1 text-white-50">{{ match_profile.height }} cms</span>,
                        <strong>Mother tongue:</strong><span class="ml-1 text-white-50">{{ match_profile.mother_tongue.name }}</span>,
                        <strong>Current location:</strong><span class="ml-1 text-white-50">{{ match_profile.current_city }}, {{ match_profile.current_state }}, {{ match_profile.current_country.name }}</span>
                        <strong>Ethnicity:</strong><span class="ml-1 text-white-50">{{ match_profile.ethnic_origin.nationality }}</span>
                        <strong>Education:</strong><span class="ml-1 text-white-50">{% for education in match_profile.education.all %}{{ education.name }}{% if not forloop.last %}, {% endif %}{% empty %}Not specified{% endfor %}</span>
                        <strong>Occupation:</strong><span class="ml-1 text-white-50">{% for occupation in match_profile.educations.all %}{{ occupation.name }}{% if not forloop.last %}, {% endif %}{% empty %}Not specified{% endfor %}</span>
                        <strong>Languages known:</strong><span class="ml-1 text-white-50">{% for language in match_profile.languages_can_speak %}{{ language.name }}{% if not forloop.last %}, {% endif %}{% empty %}Not specified{% endfor %}</span>
                    </p>
                    <p class="card-text">
                        <a href="#" class="btn btn-success btn-sm match-action{% ifequal response 'ACP' %} disabled{% endifequal %}"{% ifequal response 'ACP' %} aria-disabled="true"{% endifequal %} data-action="{% url 'matrimony:match-action' match.id 'accept' %}" style="position:relative; z-index:2;"><i class="uil-check"></i> Accept{% ifequal response 'ACP' %}ed{% endifequal %}</a>
                        <a href="#" class="btn btn-danger btn-sm match-action{% ifequal response 'REJ' %} disabled{% endifequal %}"{% ifequal response 'REJ' %} aria-disabled="true"{% endifequal %} data-action="{% url 'matrimony:match-action' match.id 'reject' %}" style="position:relative; z-index:2;"><i class="uil-times"></i> Reject{% ifequal response 'REJ' %}ed{% endifequal %}</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="card">
        <div class="card-body">
            <h4 class="header-title mt-0 mb-3">In my own words</h4>
            <p class="text-muted font-13">{{match_profile.personality}}</p>
        </div>
    </div>
</div>
<div class="row">
    <div class="card col-md-12">
        <div class="card-body">
            <h4 class="header-title mt-0 mb-3">Basic Info</h4>
            <div class="row">
                <div class="col-md-6">
                    <div class="text-left">
                        <p class="text-muted">
                            <strong>Name:</strong><span class="ml-1">{{ match_profile.name }}</span>
                        </p>
                        <p class="text-muted">
                            <strong>Spiritual name:</strong><span class="ml-1">{{ match_profile.spiritual_name }}</span>
                        </p>
                        <p class="text-muted">
                            <strong>Date of birth:</strong><span class="ml-1">{{ match_profile.dob }}</span>
                        </p>
                        <p class="text-muted">
                            <strong>Ethnic origin:</strong><span class="ml-1">{{ match_profile.ethnic_origin }}</span>
                        </p>
                        <p class="text-muted">
                            <strong>Mother tongue:</strong><span class="ml-1">{{ match_profile.mother_tongue.name }}</span>
                        </p>
                        etc...
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="text-left">
                        Other fields go here
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="card col-md-12">
        <div class="card-body">
            <h4 class="header-title mt-0 mb-3">Professional Info</h4>
            <div class="row">
            </div>
        </div>
    </div> 
</div>
<div class="row">
    <div class="card col-md-12">
        <div class="card-body">
            <h4 class="header-title mt-0 mb-3">Religion and Family</h4>
            <div class="row">
            </div>
        </div>
    </div> 
</div>
<div class="row">
    <div class="card col-md-12">
        <div class="card-body">
            <h4 class="header-title mt-0 mb-3">Expectation Summary</h4>
            <div class="row">
            </div>
        </div>
    </div> 
</div>
{% endblock content %}

{% block javascript %}
{{ block.super }}
<script type="text/javascript">
$(function(){
  $('.match-action').on('click', function(e){
    e.preventDefault();
    actionUrl = $(this).data('action');
    $.ajax
    $.ajax({
      type: "POST",
      headers: {
        'X-CSRFToken': "{{ csrf_token }}"
      },
      url: actionUrl,
      success: function (data) {
          location.reload();
      },
      error: function (err) {
          console.log("error", err.responseJSON);
      }
    });
  });
});
</script>
{% endblock %} 